<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TypeScript: any vs unknown vs never ç±»å‹è¯¦è§£</title>
  <style>
    .container {
      margin: 20px;
      padding: 20px;
      font-family: 'Courier New', monospace;
      max-width: 1400px;
    }

    .code-block {
      background-color: #f4f4f4;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      border-left: 4px solid #3498db;
      font-size: 14px;
      overflow-x: auto;
    }

    .explanation {
      margin: 20px 0;
      padding: 20px;
      background-color: #f8f9fa;
      border-left: 4px solid #2ecc71;
      border-radius: 5px;
    }

    .highlight {
      background-color: #ffeb3b;
      padding: 2px 6px;
      border-radius: 3px;
      font-weight: bold;
    }

    .output {
      background-color: #e8f5e9;
      padding: 15px;
      border-left: 4px solid #4caf50;
      margin: 10px 0;
      border-radius: 5px;
    }

    .warning {
      background-color: #fff3cd;
      padding: 15px;
      border-left: 4px solid #ffc107;
      margin: 10px 0;
      border-radius: 5px;
    }

    .error {
      background-color: #ffebee;
      padding: 15px;
      border-left: 4px solid #f44336;
      margin: 10px 0;
      border-radius: 5px;
    }

    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }

    .comparison-table th,
    .comparison-table td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: left;
      vertical-align: top;
    }

    .comparison-table th {
      background-color: #f5f5f5;
      font-weight: bold;
      text-align: center;
    }

    .type-any {
      background-color: #ffecb3;
      color: #f57f17;
      font-weight: bold;
    }

    .type-unknown {
      background-color: #e1f5fe;
      color: #0277bd;
      font-weight: bold;
    }

    .type-never {
      background-color: #fce4ec;
      color: #c2185b;
      font-weight: bold;
    }

    .safety-high {
      background-color: #c8e6c9;
      color: #2e7d32;
      font-weight: bold;
    }

    .safety-medium {
      background-color: #fff3cd;
      color: #f57f17;
      font-weight: bold;
    }

    .safety-low {
      background-color: #ffcdd2;
      color: #d32f2f;
      font-weight: bold;
    }

    .button {
      background-color: #3498db;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
      font-size: 14px;
      font-weight: bold;
    }

    .button:hover {
      background-color: #2980b9;
    }

    .mermaid-container {
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }

    .example-section {
      display: flex;
      gap: 20px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .example-card {
      flex: 1;
      min-width: 300px;
      padding: 20px;
      border-radius: 10px;
      border: 2px solid;
    }

    .card-any {
      background-color: #fffde7;
      border-color: #ff9800;
    }

    .card-unknown {
      background-color: #e3f2fd;
      border-color: #2196f3;
    }

    .card-never {
      background-color: #fce4ec;
      border-color: #e91e63;
    }

    h1,
    h2,
    h3 {
      color: #2c3e50;
    }

    .quick-ref {
      background-color: #e8f5e9;
      border: 2px solid #4caf50;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
    }

    .decision-tree {
      background-color: #f3e5f5;
      border: 2px solid #9c27b0;
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
    }

    pre {
      background-color: #2d3748;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      margin: 10px 0;
    }

    .keyword {
      color: #ff7979;
      font-weight: bold;
    }

    .type {
      color: #74b9ff;
      font-weight: bold;
    }

    .string {
      color: #6c5ce7;
    }

    .comment {
      color: #636e72;
      font-style: italic;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
</head>

<body>
  <!-- ä¸»æ ‡é¢˜ -->
  <div class="explanation">
    <h1>ğŸ¯ TypeScript: any vs unknown vs never</h1>
    <h2>ä¸‰å¤§ç‰¹æ®Šç±»å‹çš„åŒºåˆ«ä¸ä½¿ç”¨åœºæ™¯è¯¦è§£</h2>
  </div>

  <div class="container">
    <!-- å¿«é€Ÿå‚è€ƒ -->
    <div class="quick-ref">
      <h3>ğŸš€ å¿«é€Ÿå‚è€ƒ</h3>
      <ul>
        <li><span class="highlight">any</span>ï¼šå…³é—­ç±»å‹æ£€æŸ¥ï¼Œ"æˆ‘ä¸ç®¡ç±»å‹äº†"</li>
        <li><span class="highlight">unknown</span>ï¼šç±»å‹å®‰å…¨çš„anyï¼Œ"æˆ‘ä¸çŸ¥é“æ˜¯ä»€ä¹ˆç±»å‹ï¼Œä½†è¦æ£€æŸ¥"</li>
        <li><span class="highlight">never</span>ï¼šæ°¸è¿œä¸ä¼šå‡ºç°çš„ç±»å‹ï¼Œ"è¿™é‡Œæ°¸è¿œä¸ä¼šæœ‰å€¼"</li>
      </ul>
    </div>

    <!-- è¯¦ç»†å¯¹æ¯”è¡¨æ ¼ -->
    <h3>ğŸ“Š è¯¦ç»†å¯¹æ¯”è¡¨æ ¼</h3>
    <table class="comparison-table">
      <thead>
        <tr>
          <th>ç‰¹æ€§</th>
          <th class="type-any">any</th>
          <th class="type-unknown">unknown</th>
          <th class="type-never">never</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>å®šä¹‰</strong></td>
          <td>ä»»æ„ç±»å‹ï¼Œå…³é—­ç±»å‹æ£€æŸ¥</td>
          <td>é¡¶çº§ç±»å‹ï¼Œç±»å‹å®‰å…¨çš„ä»»æ„ç±»å‹</td>
          <td>åº•éƒ¨ç±»å‹ï¼Œè¡¨ç¤ºæ°¸è¿œä¸ä¼šå‡ºç°çš„å€¼</td>
        </tr>
        <tr>
          <td><strong>ç±»å‹å®‰å…¨æ€§</strong></td>
          <td class="safety-low">âŒ æä½</td>
          <td class="safety-high">âœ… é«˜</td>
          <td class="safety-high">âœ… æé«˜</td>
        </tr>
        <tr>
          <td><strong>èƒ½å¦èµ‹å€¼ç»™å…¶ä»–ç±»å‹</strong></td>
          <td class="safety-low">âœ… å¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹</td>
          <td class="safety-medium">âŒ éœ€è¦ç±»å‹æ£€æŸ¥æˆ–æ–­è¨€</td>
          <td class="safety-high">âœ… å¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹</td>
        </tr>
        <tr>
          <td><strong>å…¶ä»–ç±»å‹èƒ½å¦èµ‹å€¼ç»™å®ƒ</strong></td>
          <td class="safety-low">âœ… ä»»ä½•ç±»å‹éƒ½å¯ä»¥</td>
          <td class="safety-medium">âœ… ä»»ä½•ç±»å‹éƒ½å¯ä»¥</td>
          <td class="safety-high">âŒ æ²¡æœ‰å€¼å¯ä»¥èµ‹å€¼ç»™never</td>
        </tr>
        <tr>
          <td><strong>å¯ä»¥è°ƒç”¨æ–¹æ³•/å±æ€§å—</strong></td>
          <td class="safety-low">âœ… å¯ä»¥ï¼ˆä¸æ£€æŸ¥ï¼‰</td>
          <td class="safety-medium">âŒ éœ€è¦å…ˆç±»å‹æ£€æŸ¥</td>
          <td class="safety-high">âŒ æ°¸è¿œä¸ä¼šæœ‰å€¼</td>
        </tr>
        <tr>
          <td><strong>ä½¿ç”¨åœºæ™¯</strong></td>
          <td>
            â€¢ è¿ç§»JSä»£ç <br>
            â€¢ ç¬¬ä¸‰æ–¹åº“ç±»å‹æœªçŸ¥<br>
            â€¢ ä¸´æ—¶å…³é—­ç±»å‹æ£€æŸ¥
          </td>
          <td>
            â€¢ APIè¿”å›æ•°æ®<br>
            â€¢ ç”¨æˆ·è¾“å…¥<br>
            â€¢ åŠ¨æ€å†…å®¹å¤„ç†
          </td>
          <td>
            â€¢ å‡½æ•°æ°¸ä¸è¿”å›<br>
            â€¢ switchç©·å°½æ£€æŸ¥<br>
            â€¢ ç±»å‹æ”¶çª„çš„elseåˆ†æ”¯
          </td>
        </tr>
        <tr>
          <td><strong>æ¨èç¨‹åº¦</strong></td>
          <td class="safety-low">ğŸš¨ å°½é‡é¿å…</td>
          <td class="safety-high">âœ… æ¨èä½¿ç”¨</td>
          <td class="safety-high">âœ… é€‚å½“ä½¿ç”¨</td>
        </tr>
      </tbody>
    </table>

    <!-- ç±»å‹å…³ç³»å›¾ -->
    <h3>ğŸ”— ç±»å‹å…³ç³»å›¾</h3>
    <div class="mermaid-container">
      <div class="mermaid">
        graph TB
        unknown[unknown<br />é¡¶çº§ç±»å‹<br />æ‰€æœ‰ç±»å‹çš„è¶…ç±»]

        subgraph "å…·ä½“ç±»å‹"
        string[string]
        number[number]
        boolean[boolean]
        object[object]
        array[Array]
        func[Function]
        end

        any[any<br />ç»•è¿‡ç±»å‹ç³»ç»Ÿ<br />å¯ä»¥æ˜¯ä»»ä½•ç±»å‹]
        never[never<br />åº•éƒ¨ç±»å‹<br />æ°¸è¿œä¸ä¼šæœ‰å€¼]

        unknown --> string
        unknown --> number
        unknown --> boolean
        unknown --> object
        unknown --> array
        unknown --> func
        unknown --> any

        string --> never
        number --> never
        boolean --> never
        object --> never
        array --> never
        func --> never
        any --> never

        style unknown fill:#e3f2fd,stroke:#1976d2,stroke-width:3px
        style any fill:#fff3e0,stroke:#f57c00,stroke-width:3px
        style never fill:#fce4ec,stroke:#c2185b,stroke-width:3px
      </div>
    </div>

    <!-- ä»£ç ç¤ºä¾‹ -->
    <h3>ğŸ’» ä»£ç ç¤ºä¾‹å¯¹æ¯”</h3>
    <div class="example-section">
      <!-- anyç¤ºä¾‹ -->
      <div class="example-card card-any">
        <h4>ğŸŸ¡ any ç¤ºä¾‹ï¼ˆä¸æ¨èï¼‰</h4>
        <pre><code><span class="comment">// âŒ å…³é—­ç±»å‹æ£€æŸ¥ï¼Œå±é™©ï¼</span>
<span class="keyword">let</span> value<span class="type">: any</span> = <span class="string">"hello"</span>;

<span class="comment">// è¿™äº›éƒ½ä¸ä¼šæŠ¥é”™ï¼Œä½†è¿è¡Œæ—¶å¯èƒ½å´©æºƒ</span>
value.foo.bar.baz;  <span class="comment">// ğŸ’¥ è¿è¡Œæ—¶é”™è¯¯</span>
value();            <span class="comment">// ğŸ’¥ è¿è¡Œæ—¶é”™è¯¯</span>
value.toUpperCase(); <span class="comment">// âœ… æ­£å¸¸å·¥ä½œ</span>

<span class="comment">// å¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹</span>
<span class="keyword">let</span> str<span class="type">: string</span> = value; <span class="comment">// âœ… ç¼–è¯‘é€šè¿‡</span></code></pre>
      </div>

      <!-- unknownç¤ºä¾‹ -->
      <div class="example-card card-unknown">
        <h4>ğŸ”µ unknown ç¤ºä¾‹ï¼ˆæ¨èï¼‰</h4>
        <pre><code><span class="comment">// âœ… ç±»å‹å®‰å…¨çš„ä»»æ„ç±»å‹</span>
<span class="keyword">let</span> value<span class="type">: unknown</span> = <span class="string">"hello"</span>;

<span class="comment">// âŒ è¿™äº›ä¼šç¼–è¯‘é”™è¯¯</span>
<span class="comment">// value.toUpperCase(); // é”™è¯¯ï¼</span>
<span class="comment">// let str: string = value; // é”™è¯¯ï¼</span>

<span class="comment">// âœ… éœ€è¦ç±»å‹æ£€æŸ¥</span>
<span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">"string"</span>) {
  value.toUpperCase(); <span class="comment">// âœ… å®‰å…¨ï¼</span>
  <span class="keyword">let</span> str<span class="type">: string</span> = value; <span class="comment">// âœ… å®‰å…¨ï¼</span>
}</code></pre>
      </div>

      <!-- neverç¤ºä¾‹ -->
      <div class="example-card card-never">
        <h4>ğŸ”´ never ç¤ºä¾‹</h4>
        <pre><code><span class="comment">// âœ… æ°¸ä¸è¿”å›çš„å‡½æ•°</span>
<span class="keyword">function</span> throwError(<span class="keyword">message</span><span class="type">: string</span>)<span class="type">: never</span> {
  <span class="keyword">throw new</span> Error(message);
}

<span class="comment">// âœ… switchç©·å°½æ£€æŸ¥</span>
<span class="keyword">type</span> Color = <span class="string">"red"</span> | <span class="string">"green"</span> | <span class="string">"blue"</span>;

<span class="keyword">function</span> getColorName(color<span class="type">: Color</span>) {
  <span class="keyword">switch</span> (color) {
    <span class="keyword">case</span> <span class="string">"red"</span>: <span class="keyword">return</span> <span class="string">"çº¢è‰²"</span>;
    <span class="keyword">case</span> <span class="string">"green"</span>: <span class="keyword">return</span> <span class="string">"ç»¿è‰²"</span>;
    <span class="keyword">case</span> <span class="string">"blue"</span>: <span class="keyword">return</span> <span class="string">"è“è‰²"</span>;
    <span class="keyword">default</span>:
      <span class="keyword">const</span> _<span class="type">: never</span> = color; <span class="comment">// ç¡®ä¿æ‰€æœ‰æƒ…å†µéƒ½å¤„ç†äº†</span>
      <span class="keyword">return</span> _;
  }
}</code></pre>
      </div>
    </div>

    <!-- å†³ç­–æ ‘ -->
    <div class="decision-tree">
      <h3>ğŸ¤” å¦‚ä½•é€‰æ‹©ï¼Ÿå†³ç­–æ ‘</h3>
      <div class="mermaid">
        flowchart TD
        A[éœ€è¦å¤„ç†æœªçŸ¥ç±»å‹çš„æ•°æ®ï¼Ÿ] --> B{æ˜¯å¦éœ€è¦ç±»å‹å®‰å…¨ï¼Ÿ}
        B -->|éœ€è¦| C[ä½¿ç”¨ unknown]
        B -->|ä¸éœ€è¦<br />ä¸´æ—¶æ–¹æ¡ˆ| D[ä½¿ç”¨ any<br />âš ï¸ å°½å¿«é‡æ„]

        A --> E{æ˜¯å¦è¡¨ç¤ºæ°¸ä¸å‡ºç°çš„å€¼ï¼Ÿ}
        E -->|æ˜¯| F[ä½¿ç”¨ never]
        E -->|å¦| G[ä½¿ç”¨å…·ä½“ç±»å‹]

        C --> H[âœ… æœ€ä½³å®è·µ]
        D --> I[âš ï¸ æŠ€æœ¯å€ºåŠ¡]
        F --> J[âœ… ç±»å‹å®Œæ•´æ€§]
        G --> K[âœ… ç±»å‹æ˜ç¡®]

        style C fill:#c8e6c9
        style H fill:#c8e6c9
        style D fill:#ffcdd2
        style I fill:#ffcdd2
        style F fill:#e1bee7
        style J fill:#e1bee7
      </div>
    </div>

    <!-- å®é™…ä½¿ç”¨åœºæ™¯ -->
    <h3>ğŸ¯ å®é™…ä½¿ç”¨åœºæ™¯</h3>

    <div class="example-section">
      <div class="example-card card-unknown">
        <h4>âœ… unknown - APIæ•°æ®å¤„ç†</h4>
        <pre><code><span class="comment">// å¤„ç†APIè¿”å›çš„æ•°æ®</span>
<span class="keyword">async function</span> fetchUser(id<span class="type">: string</span>) {
  <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(<span class="string">`/api/user/${id}`</span>);
  <span class="keyword">const</span> data<span class="type">: unknown</span> = <span class="keyword">await</span> response.json();
  
  <span class="comment">// ç±»å‹ä¿æŠ¤</span>
  <span class="keyword">if</span> (isUser(data)) {
    <span class="keyword">return</span> data; <span class="comment">// ç°åœ¨dataæ˜¯Userç±»å‹</span>
  }
  <span class="keyword">throw new</span> Error(<span class="string">"Invalid user data"</span>);
}

<span class="keyword">function</span> isUser(obj<span class="type">: unknown</span>)<span class="type">: obj is User</span> {
  <span class="keyword">return</span> <span class="keyword">typeof</span> obj === <span class="string">"object"</span> && 
         obj !== <span class="keyword">null</span> && 
         <span class="string">"name"</span> <span class="keyword">in</span> obj;
}</code></pre>
      </div>

      <div class="example-card card-never">
        <h4>âœ… never - çŠ¶æ€æœºç©·å°½æ£€æŸ¥</h4>
        <pre><code><span class="comment">// çŠ¶æ€æœºçš„ç©·å°½æ£€æŸ¥</span>
<span class="keyword">type</span> LoadingState = 
  | { status<span class="type">: </span><span class="string">"loading"</span> }
  | { status<span class="type">: </span><span class="string">"success"</span>; data<span class="type">: </span>string }
  | { status<span class="type">: </span><span class="string">"error"</span>; error<span class="type">: </span>string };

<span class="keyword">function</span> handleState(state<span class="type">: LoadingState</span>) {
  <span class="keyword">switch</span> (state.status) {
    <span class="keyword">case</span> <span class="string">"loading"</span>:
      <span class="keyword">return</span> <span class="string">"åŠ è½½ä¸­..."</span>;
    <span class="keyword">case</span> <span class="string">"success"</span>:
      <span class="keyword">return</span> state.data;
    <span class="keyword">case</span> <span class="string">"error"</span>:
      <span class="keyword">return</span> <span class="string">`é”™è¯¯: ${state.error}`</span>;
    <span class="keyword">default</span>:
      <span class="comment">// å¦‚æœæ·»åŠ æ–°çŠ¶æ€å¿˜è®°å¤„ç†ï¼Œè¿™é‡Œä¼šç¼–è¯‘é”™è¯¯</span>
      <span class="keyword">const</span> _exhaustive<span class="type">: never</span> = state;
      <span class="keyword">return</span> _exhaustive;
  }
}</code></pre>
      </div>
    </div>

    <!-- æœ€ä½³å®è·µ -->
    <div class="output">
      <h3>ğŸ’¡ æœ€ä½³å®è·µå»ºè®®</h3>
      <ol>
        <li><strong>ä¼˜å…ˆä½¿ç”¨ unknown è€Œä¸æ˜¯ any</strong>
          <ul>
            <li>unknown å¼ºåˆ¶ä½ è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯</li>
            <li>any ä¼šå…³é—­ TypeScript çš„ç±»å‹ä¿æŠ¤</li>
          </ul>
        </li>
        <li><strong>åˆç†ä½¿ç”¨ never</strong>
          <ul>
            <li>ç”¨äºç©·å°½æ£€æŸ¥ï¼Œç¡®ä¿æ‰€æœ‰æƒ…å†µéƒ½è¢«å¤„ç†</li>
            <li>æ ‡è®°æ°¸è¿œä¸ä¼šåˆ°è¾¾çš„ä»£ç è·¯å¾„</li>
          </ul>
        </li>
        <li><strong>é¿å… any çš„ç­–ç•¥</strong>
          <ul>
            <li>ä½¿ç”¨ç±»å‹æ–­è¨€ï¼š<code>value as string</code></li>
            <li>ä½¿ç”¨ç±»å‹ä¿æŠ¤å‡½æ•°</li>
            <li>å®šä¹‰æ˜ç¡®çš„æ¥å£ç±»å‹</li>
          </ul>
        </li>
      </ol>
    </div>

    <!-- è¿ç§»æŒ‡å— -->
    <div class="warning">
      <h3>ğŸ”„ ä» any è¿ç§»åˆ° unknown çš„æ­¥éª¤</h3>
      <ol>
        <li><strong>ç¬¬ä¸€æ­¥</strong>ï¼šå°† <code>any</code> æ”¹ä¸º <code>unknown</code></li>
        <li><strong>ç¬¬äºŒæ­¥</strong>ï¼šè§‚å¯Ÿ TypeScript ç¼–è¯‘é”™è¯¯</li>
        <li><strong>ç¬¬ä¸‰æ­¥</strong>ï¼šæ·»åŠ ç±»å‹æ£€æŸ¥æˆ–æ–­è¨€</li>
        <li><strong>ç¬¬å››æ­¥</strong>ï¼šé€æ­¥å®šä¹‰æ›´ç²¾ç¡®çš„ç±»å‹</li>
      </ol>

      <pre><code><span class="comment">// è¿ç§»å‰</span>
<span class="keyword">function</span> processData(data<span class="type">: any</span>) {
  <span class="keyword">return</span> data.toUpperCase(); <span class="comment">// å±é™©ï¼</span>
}

<span class="comment">// è¿ç§»å</span>
<span class="keyword">function</span> processData(data<span class="type">: unknown</span>) {
  <span class="keyword">if</span> (<span class="keyword">typeof</span> data === <span class="string">"string"</span>) {
    <span class="keyword">return</span> data.toUpperCase(); <span class="comment">// å®‰å…¨ï¼</span>
  }
  <span class="keyword">throw new</span> Error(<span class="string">"Expected string"</span>);
}</code></pre>
    </div>

    <!-- æ€»ç»“ -->
    <div class="explanation">
      <h3>ğŸ“‹ æ€»ç»“</h3>
      <p>TypeScript çš„ç±»å‹ç³»ç»Ÿè®¾è®¡ç²¾å¦™ï¼š</p>
      <ul>
        <li><span class="highlight">any</span> = ç±»å‹ç³»ç»Ÿçš„"ç´§æ€¥å‡ºå£"ï¼Œåº”è¯¥è°¨æ…ä½¿ç”¨</li>
        <li><span class="highlight">unknown</span> = ç±»å‹å®‰å…¨çš„ anyï¼Œå¤„ç†æœªçŸ¥æ•°æ®çš„æœ€ä½³é€‰æ‹©</li>
        <li><span class="highlight">never</span> = ç±»å‹ç³»ç»Ÿçš„"å“¨å…µ"ï¼Œç¡®ä¿ä»£ç çš„å®Œæ•´æ€§</li>
      </ul>
      <p><strong>è®°ä½</strong>ï¼šå¥½çš„ TypeScript ä»£ç åº”è¯¥å°½é‡é¿å… <code>any</code>ï¼Œå–„ç”¨ <code>unknown</code> å’Œ <code>never</code>ï¼</p>
    </div>
  </div>

  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'default',
      flowchart: {
        useMaxWidth: true,
        htmlLabels: true
      }
    });
  </script>
</body>

</html>