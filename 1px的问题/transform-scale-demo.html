<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>transform: scale() 问题演示</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
    }

    .demo-section {
      background: white;
      margin: 20px 0;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .demo-section h2 {
      color: #e74c3c;
      margin-bottom: 15px;
      border-bottom: 2px solid #e74c3c;
      padding-bottom: 10px;
    }

    .comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }

    .demo-item {
      padding: 15px;
      background: #f8f9fa;
      border-radius: 4px;
      position: relative;
    }

    .demo-item h3 {
      margin: 0 0 10px 0;
      color: #495057;
    }

    .demo-item p {
      margin: 5px 0;
      color: #6c757d;
      font-size: 14px;
    }

    .code {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 10px;
      border-radius: 4px;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      font-size: 12px;
      margin: 10px 0;
      overflow-x: auto;
    }

    .warning {
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
    }

    .success {
      background: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
    }

    /* 问题演示：没有补偿尺寸的transform */
    .problem-demo {
      position: relative;
      padding: 20px;
      margin: 10px 0;
      background: white;
      border: 2px solid #dc3545;
    }

    .problem-demo::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border: 1px solid #28a745;
      transform: scale(0.5);
      transform-origin: 0 0;
      pointer-events: none;
    }

    /* 解决方案：补偿尺寸的transform */
    .solution-demo {
      position: relative;
      padding: 20px;
      margin: 10px 0;
      background: white;
      border: 2px solid #dc3545;
    }

    .solution-demo::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border: 1px solid #28a745;
      transform: scale(0.5);
      transform-origin: 0 0;
      pointer-events: none;
      /* 关键修复：补偿缩放后的尺寸 */
      width: 200%;
      height: 200%;
    }

    /* 对比演示：普通边框 */
    .normal-demo {
      padding: 20px;
      margin: 10px 0;
      background: white;
      border: 1px solid #6c757d;
    }

    /* 对比演示：box-shadow方案 */
    .boxshadow-demo {
      padding: 20px;
      margin: 10px 0;
      background: white;
      box-shadow: 0 0 0 0.5px #6c757d;
    }

    .visual-guide {
      position: relative;
      margin: 20px 0;
      padding: 20px;
      background: #e9ecef;
      border-radius: 4px;
    }

    .visual-guide::before {
      content: '原始尺寸';
      position: absolute;
      top: -10px;
      left: 0;
      background: #007bff;
      color: white;
      padding: 2px 8px;
      border-radius: 2px;
      font-size: 12px;
    }

    .visual-guide::after {
      content: '缩放后尺寸 (50%)';
      position: absolute;
      top: -10px;
      right: 0;
      background: #28a745;
      color: white;
      padding: 2px 8px;
      border-radius: 2px;
      font-size: 12px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>transform: scale() 问题演示与解决方案</h1>

    <div class="demo-section">
      <h2>🔍 问题分析</h2>
      <p><strong>transform: scale(0.5)</strong> 会对元素的所有属性进行缩放：</p>
      <ul>
        <li>✅ <strong>边框宽度</strong>：1px → 0.5px（这是我们想要的效果）</li>
        <li>❌ <strong>容器尺寸</strong>：100% → 50%（这会导致边框无法完全包裹容器）</li>
        <li>❌ <strong>内部内容</strong>：文字、子元素等都会变小</li>
      </ul>

      <div class="visual-guide">
        <div style="width: 100%; height: 60px; background: #007bff; opacity: 0.3; position: relative;">
          <div
            style="width: 50%; height: 30px; background: #28a745; opacity: 0.7; position: absolute; top: 15px; left: 0;">
          </div>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h2>❌ 问题演示</h2>
      <div class="comparison">
        <div class="demo-item">
          <h3>普通1px边框</h3>
          <div class="normal-demo">
            这是普通的1px边框，在高DPI屏幕上显示过粗
          </div>
          <div class="code">border: 1px solid #6c757d;</div>
        </div>
        <div class="demo-item">
          <h3>❌ 错误的transform方案</h3>
          <div class="problem-demo">
            边框无法完全包裹容器！<br>
            内容被缩放了50%
          </div>
          <div class="code">
            ::after {
            border: 1px solid #28a745;
            transform: scale(0.5);
            /* 缺少 width: 200%; height: 200%; */
            }
          </div>
        </div>
      </div>
      <div class="warning">
        <strong>问题：</strong>transform: scale(0.5) 会将整个伪元素缩小到原来的50%，
        导致边框无法完全包裹父容器。
      </div>
    </div>

    <div class="demo-section">
      <h2>✅ 解决方案对比</h2>
      <div class="comparison">
        <div class="demo-item">
          <h3>✅ 修复后的transform方案</h3>
          <div class="solution-demo">
            边框完全包裹容器！<br>
            内容保持原始大小
          </div>
          <div class="code">
            ::after {
            border: 1px solid #28a745;
            transform: scale(0.5);
            /* 关键修复 */
            width: 200%;
            height: 200%;
            }
          </div>
        </div>
        <div class="demo-item">
          <h3>✅ box-shadow方案</h3>
          <div class="boxshadow-demo">
            简单易用，无需额外元素<br>
            性能较好
          </div>
          <div class="code">box-shadow: 0 0 0 0.5px #6c757d;</div>
        </div>
      </div>
      <div class="success">
        <strong>解决方案：</strong>通过设置 <code>width: 200%; height: 200%;</code> 来补偿缩放效果，
        让边框能够完全包裹容器。
      </div>
    </div>

    <div class="demo-section">
      <h2>🔧 技术原理</h2>
      <div class="code">
        /* 原始伪元素 */
        ::after {
        width: 100%;
        height: 100%;
        border: 1px solid #ddd;
        }

        /* 应用 scale(0.5) 后 */
        ::after {
        width: 100% * 0.5 = 50%;
        height: 100% * 0.5 = 50%;
        border: 1px * 0.5 = 0.5px solid #ddd;
        }

        /* 修复：补偿缩放效果 */
        ::after {
        width: 200%; /* 200% * 0.5 = 100% */
        height: 200%; /* 200% * 0.5 = 100% */
        border: 1px solid #ddd;
        transform: scale(0.5);
        }
      </div>
    </div>

    <div class="demo-section">
      <h2>📊 方案推荐</h2>
      <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
        <thead>
          <tr style="background: #f8f9fa;">
            <th style="border: 1px solid #ddd; padding: 10px;">方案</th>
            <th style="border: 1px solid #ddd; padding: 10px;">优点</th>
            <th style="border: 1px solid #ddd; padding: 10px;">缺点</th>
            <th style="border: 1px solid #ddd; padding: 10px;">推荐场景</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="border: 1px solid #ddd; padding: 10px;"><strong>transform + 补偿</strong></td>
            <td style="border: 1px solid #ddd; padding: 10px;">真正的0.5px效果，兼容性好</td>
            <td style="border: 1px solid #ddd; padding: 10px;">需要额外元素，代码复杂</td>
            <td style="border: 1px solid #ddd; padding: 10px;">复杂场景，要求精确效果</td>
          </tr>
          <tr>
            <td style="border: 1px solid #ddd; padding: 10px;"><strong>box-shadow</strong></td>
            <td style="border: 1px solid #ddd; padding: 10px;">简单易用，无需额外元素</td>
            <td style="border: 1px solid #ddd; padding: 10px;">性能略差，某些浏览器支持问题</td>
            <td style="border: 1px solid #ddd; padding: 10px;">简单场景，快速开发</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="demo-section">
      <h2>🎯 最佳实践</h2>
      <div class="code">
        /* 推荐：box-shadow方案（简单场景） */
        .border-1px {
        box-shadow: 0 0 0 0.5px #ddd;
        }

        /* 推荐：transform方案（复杂场景） */
        .border-1px {
        position: relative;
        }
        .border-1px::after {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0; bottom: 0;
        border: 1px solid #ddd;
        transform: scale(0.5);
        transform-origin: 0 0;
        pointer-events: none;
        /* 关键：补偿缩放效果 */
        width: 200%;
        height: 200%;
        }
      </div>
    </div>
  </div>

  <script>
    // 显示设备信息
    const deviceInfo = document.createElement('div');
    deviceInfo.style.cssText = `
            position: fixed;
            top: 10px;
            right: 10px;
            background: #007bff;
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
        `;
    deviceInfo.innerHTML = `
            <strong>设备信息</strong><br>
            DPR: ${window.devicePixelRatio || 1}<br>
            宽度: ${window.innerWidth}px
        `;
    document.body.appendChild(deviceInfo);
  </script>
</body>

</html>